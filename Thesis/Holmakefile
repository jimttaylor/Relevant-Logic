RELEVANT_DIR = ../

INCLUDES = $(RELEVANT_DIR)

MASTER_THEORY = prettyPrintingTheory
MASTER_THEORY_GSE = prettyPrintingGSETheory
MASTER_THEORY_ND = prettyPrintingNDTheory


EXTRA_CLEANS = holtexbasic.sty proof.sty munger munger0.o mungernd mungergse chpt1intro.tex chpt2background.tex chpt3hilbert.tex chpt3ND.tex chpt4rmsemantics.tex chpt5coversemantics.tex chpt6decidability.tex chpt7conclusion.tex tmp/ PDFs/

all: output_dir thesis chpt1 chpt2 chpt3 chpt4 chpt5 chpt6 chpt7 thesis
	mv tmp/*.pdf PDFs

thesis: chpt1intro.tex chpt2background.tex chpt3hilbert.tex chpt3ND.tex chpt4rmsemantics.tex chpt5coversemantics.tex chpt6decidability.tex chpt7conclusion.tex tmp_dir
	pdflatex -output-directory=tmp thesis.tex; \
    bibtex ./tmp/thesis.aux;                   \
	pdflatex -output-directory=tmp thesis.tex; \
	pdflatex -output-directory=tmp thesis.tex

chpt1: chpt1intro.tex tmp_dir
	pdflatex -output-directory=tmp chpt1.tex

chpt2: chpt2background.tex tmp_dir
	pdflatex -output-directory=tmp chpt2.tex

chpt3: chpt3hilbert.tex chpt3ND.tex tmp_dir 
	pdflatex -output-directory=tmp chpt3.tex

chpt4: chpt4rmsemantics.tex tmp_dir
	pdflatex -output-directory=tmp chpt4.tex

chpt5: chpt5coversemantics.tex tmp_dir
	pdflatex -output-directory=tmp chpt5.tex

chpt6: chpt6decidability.tex tmp_dir
	pdflatex -output-directory=tmp chpt6.tex

chpt7: chpt7conclusion.tex tmp_dir
	pdflatex -output-directory=tmp chpt7.tex

tmp_dir: 
	mkdir -p tmp

output_dir: 
	mkdir -p PDFs

chpt1intro.tex: chpt1intro.htex munger holtexbasic.sty proof.sty overrides
	./munger -mc overrides < $< > $@

chpt2background.tex: chpt2background.htex munger holtexbasic.sty proof.sty overrides
	./munger -mc overrides < $< > $@

chpt3hilbert.tex: chpt3hilbert.htex mungergse holtexbasic.sty proof.sty overrides-goldblatt-slaney-equiv
	./mungergse -mc overrides-goldblatt-slaney-equiv < $< > $@

chpt3ND.tex: chpt3ND.htex mungernd holtexbasic.sty proof.sty overrides-nd
	./mungernd -mc overrides-nd < $< > $@

chpt4rmsemantics.tex: chpt4rmsemantics.htex munger holtexbasic.sty proof.sty overrides
	./munger -mc overrides < $< > $@

chpt5coversemantics.tex: chpt5coversemantics.htex munger holtexbasic.sty proof.sty overrides
	./munger -mc overrides < $< > $@

chpt6decidability.tex: chpt6decidability.htex munger holtexbasic.sty proof.sty overrides
	./munger -mc overrides < $< > $@

chpt7conclusion.tex: chpt7conclusion.htex munger holtexbasic.sty proof.sty overrides
	./munger -mc overrides < $< > $@

munger: $(dprot $(MASTER_THEORY)).uo $(dprot $(HOLDIR)/bin/mkmunge.exe)
	$(protect $(HOLDIR)/bin/mkmunge.exe) -o $@ $(MASTER_THEORY)

mungergse: $(dprot $(MASTER_THEORY_GSE)).uo $(dprot $(HOLDIR)/bin/mkmunge.exe)
	$(protect $(HOLDIR)/bin/mkmunge.exe) -o $@ $(MASTER_THEORY_GSE)

mungernd: $(dprot $(MASTER_THEORY_ND)).uo $(dprot $(HOLDIR)/bin/mkmunge.exe)
	$(protect $(HOLDIR)/bin/mkmunge.exe) -o $@ $(MASTER_THEORY_ND)

holtexbasic.sty: $(HOLDIR)/src/TeX/holtexbasic.sty
	$(CP) $< $@

proof.sty: $(HOLDIR)/Manual/LaTeX/proof.sty
	$(CP) $< $@